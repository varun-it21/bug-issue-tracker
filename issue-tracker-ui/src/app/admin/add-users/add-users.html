<h2>User Management ğŸ‘¤</h2>

<div class="filters">
  <input type="text" placeholder="Search name..." [(ngModel)]="searchText">
   <button class="btn-add" (click)="openAddUser()">â• Add User</button>
</div>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Email</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let user of users; trackBy: trackByUserId">
      <td>{{ user.userId }}</td>
      <td>{{ user.user_name }}</td>
      <td>{{ user.user_email }}</td>
      <td>
        <span *ngIf="user.is_active" class="active">Active</span>
        <span *ngIf="!user.is_active" class="inactive">Inactive</span>
      </td>
      <td>
        <button class="btn-view" (click)="openView(user)">View</button>
        <button class="btn-edit" (click)="openEdit(user)">Edit</button>
        <button class="btn-delete" (click)="openDelete(user)">Delete</button>
      </td>
    </tr>
  </tbody>
</table>


<div class="modal" *ngIf="showAddUser">
  <div class="modal-content">
    <h3>Add User ğŸ‘¤</h3>

    <label>Name</label>
    <input [(ngModel)]="newUser.user_name">

    <label>Email</label>
    <input [(ngModel)]="newUser.user_email">

    <label>Password</label>
    <input type="password" [(ngModel)]="newUser.password">

    <label>Role</label>
    <select [(ngModel)]="newUser.role_id">
      <option [value]="1">Admin</option>
      <option [value]="2">Developer</option>
    </select>

    <label>Status</label>
    <select [(ngModel)]="newUser.is_active">
      <option [value]="true">Active</option>
      <option [value]="false">Inactive</option>
    </select>

    <div class="modal-actions">
      <button (click)="addUser()">Save</button>
      <button (click)="closeAddUser()">Cancel</button>
    </div>
  </div>
</div>

<!-- ================= VIEW USER POPUP ================= -->
<div class="modal" *ngIf="showView">
  <div class="modal-content">
    <h3>View User ğŸ‘ï¸</h3>
    <p><b>ID:</b> {{ this.selectedUser.userId}}</p>
    <p><b>Name:</b> {{ selectedUser.user_name }}</p>
    <p><b>Email:</b> {{ selectedUser.user_email }}</p>
    <p><b>Status:</b> {{ selectedUser.is_active ? 'Active' : 'Inactive' }}</p>
    <button (click)="closePopup()">Close</button>
  </div>
</div>

<!-- ================= EDIT USER POPUP ================= -->
<div class="modal" *ngIf="showEdit">
  <div class="modal-content">
    <h3>Edit User âœï¸</h3>

    <input [(ngModel)]="selectedUser.user_name">
    <input [(ngModel)]="selectedUser.user_email">

    <select [(ngModel)]="selectedUser.is_active">
      <option [value]="true">Active</option>
      <option [value]="false">Inactive</option>
    </select>

    <div class="modal-actions">
      <button (click)="saveEdit()">Update</button>
      <button (click)="closePopup()">Cancel</button>
    </div>
  </div>
</div>

<!-- ================= DELETE USER POPUP ================= -->
<div class="modal" *ngIf="showDelete">
  <div class="modal-content">
    <h3>Delete User ğŸ—‘ï¸</h3>
    <p>Are you sure you want to delete <b>{{ selectedUser.user_name }}</b>?</p>

    <div class="modal-actions">
      <button (click)="confirmDelete()">Yes</button>
      <button (click)="closePopup()">Cancel</button>
    </div>
  </div>
</div>
